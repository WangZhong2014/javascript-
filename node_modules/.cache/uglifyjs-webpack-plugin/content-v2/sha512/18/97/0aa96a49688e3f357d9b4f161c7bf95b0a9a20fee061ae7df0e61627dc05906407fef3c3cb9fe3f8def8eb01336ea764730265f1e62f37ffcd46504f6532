{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[285],{71:function(e,a,t){\"use strict\";t.r(a);var s=t(0),n=Object(s.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var e=this,a=e.$createElement,t=e._self._c||a;return t(\"div\",{staticClass:\"content\"},[t(\"h1\",{attrs:{id:\"delayed-stream\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#delayed-stream\",\"aria-hidden\":\"true\"}},[e._v(\"#\")]),e._v(\" delayed-stream\")]),t(\"p\",[e._v(\"Buffers events from a stream until you are ready to handle them.\")]),t(\"h2\",{attrs:{id:\"installation\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#installation\",\"aria-hidden\":\"true\"}},[e._v(\"#\")]),e._v(\" Installation\")]),t(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[t(\"code\",[t(\"span\",{attrs:{class:\"token function\"}},[e._v(\"npm\")]),e._v(\" \"),t(\"span\",{attrs:{class:\"token function\"}},[e._v(\"install\")]),e._v(\" delayed-stream\\n\")])]),t(\"h2\",{attrs:{id:\"usage\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#usage\",\"aria-hidden\":\"true\"}},[e._v(\"#\")]),e._v(\" Usage\")]),t(\"p\",[e._v(\"The following example shows how to write a http echo server that delays its\\nresponse by 1000 ms.\")]),t(\"pre\",{pre:!0,attrs:{class:\"language-javascript\"}},[t(\"code\",[t(\"span\",{attrs:{class:\"token keyword\"}},[e._v(\"var\")]),e._v(\" DelayedStream \"),t(\"span\",{attrs:{class:\"token operator\"}},[e._v(\"=\")]),e._v(\" \"),t(\"span\",{attrs:{class:\"token function\"}},[e._v(\"require\")]),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\"(\")]),t(\"span\",{attrs:{class:\"token string\"}},[e._v(\"'delayed-stream'\")]),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\")\")]),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\";\")]),e._v(\"\\n\"),t(\"span\",{attrs:{class:\"token keyword\"}},[e._v(\"var\")]),e._v(\" http \"),t(\"span\",{attrs:{class:\"token operator\"}},[e._v(\"=\")]),e._v(\" \"),t(\"span\",{attrs:{class:\"token function\"}},[e._v(\"require\")]),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\"(\")]),t(\"span\",{attrs:{class:\"token string\"}},[e._v(\"'http'\")]),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\")\")]),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\";\")]),e._v(\"\\n\\nhttp\"),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\".\")]),t(\"span\",{attrs:{class:\"token function\"}},[e._v(\"createServer\")]),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\"(\")]),t(\"span\",{attrs:{class:\"token keyword\"}},[e._v(\"function\")]),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\"(\")]),e._v(\"req\"),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\",\")]),e._v(\" res\"),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\")\")]),e._v(\" \"),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\"{\")]),e._v(\"\\n  \"),t(\"span\",{attrs:{class:\"token keyword\"}},[e._v(\"var\")]),e._v(\" delayed \"),t(\"span\",{attrs:{class:\"token operator\"}},[e._v(\"=\")]),e._v(\" DelayedStream\"),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\".\")]),t(\"span\",{attrs:{class:\"token function\"}},[e._v(\"create\")]),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\"(\")]),e._v(\"req\"),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\")\")]),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\";\")]),e._v(\"\\n\\n  \"),t(\"span\",{attrs:{class:\"token function\"}},[e._v(\"setTimeout\")]),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\"(\")]),t(\"span\",{attrs:{class:\"token keyword\"}},[e._v(\"function\")]),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\"(\")]),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\")\")]),e._v(\" \"),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\"{\")]),e._v(\"\\n    res\"),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\".\")]),t(\"span\",{attrs:{class:\"token function\"}},[e._v(\"writeHead\")]),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\"(\")]),t(\"span\",{attrs:{class:\"token number\"}},[e._v(\"200\")]),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\")\")]),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\";\")]),e._v(\"\\n    delayed\"),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\".\")]),t(\"span\",{attrs:{class:\"token function\"}},[e._v(\"pipe\")]),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\"(\")]),e._v(\"res\"),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\")\")]),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\";\")]),e._v(\"\\n  \"),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\"}\")]),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\",\")]),e._v(\" \"),t(\"span\",{attrs:{class:\"token number\"}},[e._v(\"1000\")]),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\")\")]),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\";\")]),e._v(\"\\n\"),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\"}\")]),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\")\")]),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\";\")]),e._v(\"\\n\")])]),t(\"p\",[e._v(\"If you are not using \"),t(\"code\",[e._v(\"Stream#pipe\")]),e._v(\", you can also manually release the buffered\\nevents by calling \"),t(\"code\",[e._v(\"delayedStream.resume()\")]),e._v(\":\")]),t(\"pre\",{pre:!0,attrs:{class:\"language-javascript\"}},[t(\"code\",[t(\"span\",{attrs:{class:\"token keyword\"}},[e._v(\"var\")]),e._v(\" delayed \"),t(\"span\",{attrs:{class:\"token operator\"}},[e._v(\"=\")]),e._v(\" DelayedStream\"),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\".\")]),t(\"span\",{attrs:{class:\"token function\"}},[e._v(\"create\")]),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\"(\")]),e._v(\"req\"),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\")\")]),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\";\")]),e._v(\"\\n\\n\"),t(\"span\",{attrs:{class:\"token function\"}},[e._v(\"setTimeout\")]),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\"(\")]),t(\"span\",{attrs:{class:\"token keyword\"}},[e._v(\"function\")]),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\"(\")]),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\")\")]),e._v(\" \"),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\"{\")]),e._v(\"\\n  \"),t(\"span\",{attrs:{class:\"token comment\"}},[e._v(\"// Emit all buffered events and resume underlaying source\")]),e._v(\"\\n  delayed\"),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\".\")]),t(\"span\",{attrs:{class:\"token function\"}},[e._v(\"resume\")]),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\"(\")]),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\")\")]),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\";\")]),e._v(\"\\n\"),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\"}\")]),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\",\")]),e._v(\" \"),t(\"span\",{attrs:{class:\"token number\"}},[e._v(\"1000\")]),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\")\")]),t(\"span\",{attrs:{class:\"token punctuation\"}},[e._v(\";\")]),e._v(\"\\n\")])]),t(\"h2\",{attrs:{id:\"implementation\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#implementation\",\"aria-hidden\":\"true\"}},[e._v(\"#\")]),e._v(\" Implementation\")]),t(\"p\",[e._v(\"In order to use this meta stream properly, here are a few things you should\\nknow about the implementation.\")]),t(\"h3\",{attrs:{id:\"event-buffering-proxying\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#event-buffering-proxying\",\"aria-hidden\":\"true\"}},[e._v(\"#\")]),e._v(\" Event Buffering / Proxying\")]),t(\"p\",[e._v(\"All events of the \"),t(\"code\",[e._v(\"source\")]),e._v(\" stream are hijacked by overwriting the \"),t(\"code\",[e._v(\"source.emit\")]),e._v(\"\\nmethod. Until node implements a catch-all event listener, this is the only way.\")]),t(\"p\",[e._v(\"However, delayed-stream still continues to emit all events it captures on the\\n\"),t(\"code\",[e._v(\"source\")]),e._v(\", regardless of whether you have released the delayed stream yet or\\nnot.\")]),t(\"p\",[e._v(\"Upon creation, delayed-stream captures all \"),t(\"code\",[e._v(\"source\")]),e._v(\" events and stores them in\\nan internal event buffer. Once \"),t(\"code\",[e._v(\"delayedStream.release()\")]),e._v(\" is called, all\\nbuffered events are emitted on the \"),t(\"code\",[e._v(\"delayedStream\")]),e._v(\", and the event buffer is\\ncleared. After that, delayed-stream merely acts as a proxy for the underlaying\\nsource.\")]),t(\"h3\",{attrs:{id:\"error-handling\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#error-handling\",\"aria-hidden\":\"true\"}},[e._v(\"#\")]),e._v(\" Error handling\")]),t(\"p\",[e._v(\"Error events on \"),t(\"code\",[e._v(\"source\")]),e._v(\" are buffered / proxied just like any other events.\\nHowever, \"),t(\"code\",[e._v(\"delayedStream.create\")]),e._v(\" attaches a no-op \"),t(\"code\",[e._v(\"'error'\")]),e._v(\" listener to the\\n\"),t(\"code\",[e._v(\"source\")]),e._v(\". This way you only have to handle errors on the \"),t(\"code\",[e._v(\"delayedStream\")]),e._v(\"\\nobject, rather than in two places.\")]),t(\"h3\",{attrs:{id:\"buffer-limits\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#buffer-limits\",\"aria-hidden\":\"true\"}},[e._v(\"#\")]),e._v(\" Buffer limits\")]),t(\"p\",[e._v(\"delayed-stream provides a \"),t(\"code\",[e._v(\"maxDataSize\")]),e._v(\" property that can be used to limit\\nthe amount of data being buffered. In order to protect you from bad \"),t(\"code\",[e._v(\"source\")]),e._v(\"\\nstreams that don't react to \"),t(\"code\",[e._v(\"source.pause()\")]),e._v(\", this feature is enabled by\\ndefault.\")]),t(\"h2\",{attrs:{id:\"api\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#api\",\"aria-hidden\":\"true\"}},[e._v(\"#\")]),e._v(\" API\")]),t(\"h3\",{attrs:{id:\"delayedstream-create-source-options\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#delayedstream-create-source-options\",\"aria-hidden\":\"true\"}},[e._v(\"#\")]),e._v(\" DelayedStream.create(source, [options])\")]),t(\"p\",[e._v(\"Returns a new \"),t(\"code\",[e._v(\"delayedStream\")]),e._v(\". Available options are:\")]),t(\"ul\",[t(\"li\",[t(\"code\",[e._v(\"pauseStream\")])]),t(\"li\",[t(\"code\",[e._v(\"maxDataSize\")])])]),t(\"p\",[e._v(\"The description for those properties can be found below.\")]),t(\"h3\",{attrs:{id:\"delayedstream-source\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#delayedstream-source\",\"aria-hidden\":\"true\"}},[e._v(\"#\")]),e._v(\" delayedStream.source\")]),t(\"p\",[e._v(\"The \"),t(\"code\",[e._v(\"source\")]),e._v(\" stream managed by this object. This is useful if you are\\npassing your \"),t(\"code\",[e._v(\"delayedStream\")]),e._v(\" around, and you still want to access properties\\non the \"),t(\"code\",[e._v(\"source\")]),e._v(\" object.\")]),t(\"h3\",{attrs:{id:\"delayedstream-pausestream-true\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#delayedstream-pausestream-true\",\"aria-hidden\":\"true\"}},[e._v(\"#\")]),e._v(\" delayedStream.pauseStream = true\")]),t(\"p\",[e._v(\"Whether to pause the underlaying \"),t(\"code\",[e._v(\"source\")]),e._v(\" when calling\\n\"),t(\"code\",[e._v(\"DelayedStream.create()\")]),e._v(\". Modifying this property afterwards has no effect.\")]),t(\"h3\",{attrs:{id:\"delayedstream-maxdatasize-1024-1024\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#delayedstream-maxdatasize-1024-1024\",\"aria-hidden\":\"true\"}},[e._v(\"#\")]),e._v(\" delayedStream.maxDataSize = 1024 * 1024\")]),t(\"p\",[e._v(\"The amount of data to buffer before emitting an \"),t(\"code\",[e._v(\"error\")]),e._v(\".\")]),t(\"p\",[e._v(\"If the underlaying source is emitting \"),t(\"code\",[e._v(\"Buffer\")]),e._v(\" objects, the \"),t(\"code\",[e._v(\"maxDataSize\")]),e._v(\"\\nrefers to bytes.\")]),t(\"p\",[e._v(\"If the underlaying source is emitting JavaScript strings, the size refers to\\ncharacters.\")]),t(\"p\",[e._v(\"If you know what you are doing, you can set this property to \"),t(\"code\",[e._v(\"Infinity\")]),e._v(\" to\\ndisable this feature. You can also modify this property during runtime.\")]),t(\"h3\",{attrs:{id:\"delayedstream-datasize-0\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#delayedstream-datasize-0\",\"aria-hidden\":\"true\"}},[e._v(\"#\")]),e._v(\" delayedStream.dataSize = 0\")]),t(\"p\",[e._v(\"The amount of data buffered so far.\")]),t(\"h3\",{attrs:{id:\"delayedstream-readable\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#delayedstream-readable\",\"aria-hidden\":\"true\"}},[e._v(\"#\")]),e._v(\" delayedStream.readable\")]),t(\"p\",[e._v(\"An ECMA5 getter that returns the value of \"),t(\"code\",[e._v(\"source.readable\")]),e._v(\".\")]),t(\"h3\",{attrs:{id:\"delayedstream-resume\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#delayedstream-resume\",\"aria-hidden\":\"true\"}},[e._v(\"#\")]),e._v(\" delayedStream.resume()\")]),t(\"p\",[e._v(\"If the \"),t(\"code\",[e._v(\"delayedStream\")]),e._v(\" has not been released so far, \"),t(\"code\",[e._v(\"delayedStream.release()\")]),e._v(\"\\nis called.\")]),t(\"p\",[e._v(\"In either case, \"),t(\"code\",[e._v(\"source.resume()\")]),e._v(\" is called.\")]),t(\"h3\",{attrs:{id:\"delayedstream-pause\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#delayedstream-pause\",\"aria-hidden\":\"true\"}},[e._v(\"#\")]),e._v(\" delayedStream.pause()\")]),t(\"p\",[e._v(\"Calls \"),t(\"code\",[e._v(\"source.pause()\")]),e._v(\".\")]),t(\"h3\",{attrs:{id:\"delayedstream-pipe-dest\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#delayedstream-pipe-dest\",\"aria-hidden\":\"true\"}},[e._v(\"#\")]),e._v(\" delayedStream.pipe(dest)\")]),t(\"p\",[e._v(\"Calls \"),t(\"code\",[e._v(\"delayedStream.resume()\")]),e._v(\" and then proxies the arguments to \"),t(\"code\",[e._v(\"source.pipe\")]),e._v(\".\")]),t(\"h3\",{attrs:{id:\"delayedstream-release\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#delayedstream-release\",\"aria-hidden\":\"true\"}},[e._v(\"#\")]),e._v(\" delayedStream.release()\")]),t(\"p\",[e._v(\"Emits and clears all events that have been buffered up so far. This does not\\nresume the underlaying source, use \"),t(\"code\",[e._v(\"delayedStream.resume()\")]),e._v(\" instead.\")]),t(\"h2\",{attrs:{id:\"license\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#license\",\"aria-hidden\":\"true\"}},[e._v(\"#\")]),e._v(\" License\")]),t(\"p\",[e._v(\"delayed-stream is licensed under the MIT license.\")])])}],!1,null,null,null);a.default=n.exports}}]);","extractedComments":[]}